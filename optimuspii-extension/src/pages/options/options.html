<!DOCTYPE html>
<html>

<head>
  <title>OptimusPII</title>
  <link rel="stylesheet" href="options.css">
</head>

<body>
  <div class="header-container">
    <img src="../icon/icon.png" alt="OptimusPII Logo" class="logo">
    <h1 class="page-title">OptimusPII</h1>
  </div>

  <div class="tabs-container">
    <div class="tabs">
      <div class="tab active" data-tab="policies">Policies</div>
      <div class="tab" data-tab="domains">Domain Mappings</div>
      <div class="tab" data-tab="patterns">Pattern Repository</div>
      <div class="tab" data-tab="settings">Global Settings</div>
    </div>

    <!-- Policies Tab -->
    <div class="tab-content active" id="policies-content">
      <div class="section">
        <h2>Protection Policies</h2>
        
        <div class="policy-list" id="policy-list">
          <!-- Policy items will be populated here -->
        </div>
        
        <div class="policy-editor hidden" id="policy-editor">
          <div class="policy-editor-header">
            <h3 class="policy-editor-title">Edit Policy</h3>
          </div>
          
          <div class="form-group">
            <label for="policy-name">Policy Name</label>
            <input type="text" id="policy-name" class="form-control" placeholder="Enter policy name">
          </div>
          
          <div class="form-group">
            <label for="policy-type">Policy Type</label>
            <select id="policy-type" class="form-control">
              <option value="pasteProtection">Paste Protection</option>
              <option value="fileUploadProtection">File Upload Protection</option>
              <option value="fileDownloadProtection">File Download Protection</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="policy-mode">Operation Mode</label>
            <select id="policy-mode" class="form-control">
              <option value="interactive">Interactive - Show confirmation dialog</option>
              <option value="block-and-alert">Block and Alert - Prevent and notify</option>
              <option value="alert-only">Alert Only - Allow but warn</option>
              <option value="silent-block">Silent Block - Prevent without notifying</option>
              <option value="redact-and-paste">Redact and Paste - Auto-replace sensitive data</option>
              <option value="disabled">Disabled - No protection</option>
            </select>
          </div>
          
          <div class="form-group" id="enabled-patterns-container">
            <label>Enabled Detection Patterns</label>
            <div class="pattern-list" id="pattern-list">
              <!-- Patterns will be populated here -->
            </div>
          </div>
          
          <div class="form-group" id="blocked-extensions-container">
            <label>Blocked File Extensions</label>
            <div class="pattern-list" id="extension-list">
              <!-- Extensions will be populated here -->
            </div>
          </div>
          
          <div class="form-group">
            <div class="form-check">
              <input type="checkbox" id="policy-enabled" class="form-check-input" checked>
              <label for="policy-enabled">Policy Enabled</label>
            </div>
          </div>
          
          <div class="action-bar">
            <div>
              <button id="cancel-policy-edit" class="button-secondary">Cancel</button>
            </div>
            <div>
              <button id="delete-policy" class="button-danger">Delete Policy</button>
              <button id="save-policy">Save Policy</button>
            </div>
          </div>
        </div>
        
        <button id="create-policy">Create New Policy</button>
      </div>
    </div>

    <!-- Domain Mappings Tab -->
    <div class="tab-content" id="domains-content">
      <div class="section">
        <h2>Domain to Policy Mappings</h2>
        
        <div class="domain-mapping-container" id="domain-mapping-container">
          <!-- Domain mappings will be populated here -->
        </div>
        
        <div id="domain-mapping-editor" class="policy-editor hidden">
          <div class="form-group">
            <label for="domain-pattern">Domain Pattern</label>
            <input type="text" id="domain-pattern" class="form-control" placeholder="e.g., *://chatgpt.com/*">
            <div class="help-text">Use * for wildcard matching. Examples: *://chatgpt.com/*, https://*.example.com/*</div>
          </div>
          
          <div class="form-group">
            <label>Applied Policies</label>
            <div class="pattern-list" id="applied-policies-list">
              <!-- Available policies checkboxes will be populated here -->
            </div>
          </div>
          
          <div class="action-bar">
            <div>
              <button id="cancel-domain-edit" class="button-secondary">Cancel</button>
            </div>
            <div>
              <button id="delete-domain-mapping" class="button-danger">Delete Mapping</button>
              <button id="save-domain-mapping">Save Mapping</button>
            </div>
          </div>
        </div>
        
        <button id="create-domain-mapping">Add Domain Mapping</button>
      </div>
    </div>

    <!-- Pattern Repository Tab -->
    <div class="tab-content" id="patterns-content">
      <div class="section">
        <h2>Built-in Detection Patterns</h2>
        <div id="default-regex-container">
          <!-- Default regex patterns will be populated here -->
        </div>

        <h2>Custom Detection Patterns</h2>
        <div id="custom-regex-container">
          <div id="regex-template" class="custom-regex-row hidden">
            <div class="row">
              <input type="text" class="regex-name" placeholder="Name (e.g. 'Credit Card')" />
              <input type="text" class="regex-pattern" placeholder="Regex pattern" />
            </div>
            <div class="row">
              <input type="text" class="regex-sample" placeholder="Sample replacement data" />
              <button type="button" class="remove-regex">Remove</button>
            </div>
          </div>
        </div>

        <button type="button" id="add-regex">Add Pattern</button>
        <div class="help-text">Sample data will be used as replacement when choosing to paste redacted values.</div>
      </div>
    </div>

    <!-- Global Settings Tab -->
    <div class="tab-content" id="settings-content">
      <div class="setting-group">
        <h2>File Extension Blocking</h2>
        <div class="help-text">File extensions to be blocked globally when not covered by specific policies</div>

        <div id="custom-file-ext-container">
          <div id="file-ext-template" class="file-ext-row hidden">
            <input type="text" class="file-ext-pattern" placeholder="Add file extension" />
            <button type="button" class="remove-ext">X</button>
          </div>
        </div>

        <button type="button" id="add-ext">Add Extension</button>
      </div>

      <div class="section">
        <h2>Websites to Monitor</h2>
        <div class="help-text">Use patterns like "https://example.com/*" to match all pages on a domain. 
          Use "*://*.example.com/*" to match all subdomains and protocols.</div>

        <div id="custom-url-container">
          <div id="url-template" class="custom-url-row hidden">
            <input type="text" class="url-pattern" placeholder="URL pattern (e.g., 'https://example.com/*')" />
            <button type="button" class="remove-url">X</button>
          </div>
        </div>

        <button type="button" id="add-url">Add Website</button>
      </div>
    </div>
  </div>

  <!-- Save button for entire config -->
  <button id="save" disabled>Apply All Settings <span class="unsaved-indicator">Unsaved changes</span></button>
  <div id="status" class="status">Settings saved</div>

  <!-- Modals -->
  <div id="confirm-delete-modal" class="modal hidden">
    <div class="modal-content">
      <div class="modal-header">
        <h3 class="modal-title">Confirm Delete</h3>
        <button class="modal-close">&times;</button>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this item? This action cannot be undone.</p>
      </div>
      <div class="modal-footer">
        <button id="cancel-delete" class="button-secondary">Cancel</button>
        <button id="confirm-delete" class="button-danger">Delete</button>
      </div>
    </div>
  </div>

  <script src="../background.js"></script>
  <script src="options.js"></script>
</body>

</html>